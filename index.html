<!DOCTYPE html>
<html lang="en">
<head>
    <title>Xyra - Stream</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Xyra - A place to discover movies and TV shows. Watch anytime, anywhere.">
    <meta name="keywords" content="Xyra streaming, Xyra movies, Xyra TV shows, free movie streaming, free TV shows online, watch movies online, stream TV shows, online movie streaming, HD movies free, TV series streaming, Xyra free movies, Xyra stream movies, watch TV shows online, popular movies 2024, trending TV shows, best streaming platform, free movie site, watch free movies, Xyra media streaming, high-quality movie streaming, movie library online, binge-watch movies, latest movie releases, HD streaming movies, free series streaming, full episodes online">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Xyra - Discover, Watch, Enjoy Anytime, Anywhere">
    <meta property="og:description" content="Xyra - A place to discover movies and TV shows. Watch anytime, anywhere.">
    <meta property="og:image" content="https://raw.githubusercontent.com/junioralive/Xyra/refs/heads/main/assets/xyra.png">
    <meta property="og:url" content="https://xyrastream.live"> <!-- Replace with actual URL -->
    <meta property="og:type" content="website">
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/junioralive/Xyra/refs/heads/main/assets/xyra.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Basic Styling */
        body {
            background-color: #121212;
            color: #E0E0E0;
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Main Container Styling */
        .container {
            max-width: 1200px;
            width: 95%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px 10px;
            background: #1E1E1E;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            gap: 20px;
            transition: all 0.5s ease;
            position: relative;
        }

        /* Top Button Container */
        .top-buttons {
            position: absolute;
            top: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
        }

        /* Home Button Styling */
        .top-button {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #E0E0E0;
            border-radius: 50%;
            cursor: pointer;
            text-decoration: none;
            font-size: 1.5em;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        /* Adjusting position for top-left button */
        .top-button-left {
            position: absolute;
            top: 10px;
            left: 15px;
        }

        /* Adjusting position for top-right button */
        .top-button-right {
            position: absolute;
            top: 10px;
            right: 15px;
        }

        .top-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Move to top on input */
        .container.top-align {
            justify-content: flex-start;
            padding-top: 20px;
        }

        /* Title Styling */
        .title-container {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
        }

        .title-icon {
            width: 40px;
            height: 40px;
        }

        .title {
            font-weight: bold;
            color: #FFFFFF;
            margin: 0;
        }

        /* Search Bar */
        .search-bar {
            position: relative;
            width: 100%;
            max-width: 500px;
            text-align: center;
        }

        .search-input {
            width: 100%;
            padding: 12px;
            background-color: #181818;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: #E0E0E0;
            font-size: 1rem;
            text-align: center;
            transition: all 0.5s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Additional Styles for Continue Watching Section */
        .section-title {
            width: 100%;
            max-width: 1200px;
            margin: 20px 0 10px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #E0E0E0;
            text-align: center;
        }
        /* Remove Button on Media Card */
        .remove-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(255, 255, 255, 0.3);
            color: #FFFFFF;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }

        .remove-button:hover {
            background-color: rgba(255, 0, 0, 0.9);
        }

        .hidden {
            display: none;
        }

        /* Suggestions Container */
        .suggestions-container {
            opacity: 0;
            transition: opacity 0.5s ease;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            padding: 10px;
            max-height: 100%;
            overflow-y: auto;
            scrollbar-width: none;
            width: 100%;
            transition: opacity 0.5s ease;
        }

        /* Show suggestions */
        .suggestions-container.show {
            opacity: 1;
        }

        .suggestions-container::-webkit-scrollbar {
            width: 6px;
        }

        .suggestions-container::-webkit-scrollbar-thumb {
            background-color: #333;
            border-radius: 3px;
        }

        /* Suggestion Card */
        .suggestion-card {
            background-color: #181818;
            border: none;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            text-align: center;
            color: #E0E0E0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            padding-bottom: 10px;
        }


        .suggestion-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(255, 255, 255, 0.2);
        }

        /* Image with Border Effect */
        .suggestion-image {
            width: 100%;
            height: 260px;
            object-fit: cover;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            margin-bottom: -4px;
        }

        /* Details Container */
        .suggestion-details {
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Title Styling */
        .suggestion-title {
            font-size: 1rem;
            font-weight: 600;
            color: #FFFFFF;
            margin-top: 8px;
            white-space: normal;
            overflow: hidden;
            text-align: center;
            display: -webkit-box;
            -webkit-box-orient: vertical;
        }

        /* Subtitle Styling */
        .suggestion-subtitle {
            font-size: 0.85rem;
            color: #BBBBBB;
            margin-top: 4px;
            text-align: center;
        }

        /* Footer Styling */
        .footer {
            margin-top: 10px;
            color: #AAA;
            font-size: 0.9em;
            text-align: center;
        }

        .footer a {
            color: #E0E0E0;
            text-decoration: none;
        }

        .footer small {
            display: block;
            margin-top: 5px;
            font-size: 0.85em;
            color: #FF5555;
        }

        /* Responsive Styling */
        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 10px;
            }
            .title, .section-title {
                font-size: 1.5rem;
                text-align: center;
            }
            .search-bar {
                width: 100%;
                max-width: 280px;
            }
            .search-input {
                padding: 10px;
                font-size: 0.9rem;
            }
            .suggestions-container {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            .suggestion-card {
                min-height: 350px;
            }
            .suggestion-title {
                font-size: 0.9rem;
            }
            .suggestion-subtitle {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                width: 95%;
                padding: 10px;
            }
            .title, .section-title {
                font-size: 1.25rem;
                text-align: center;
            }
            .search-bar {
                width: 100%;
                max-width: 280px;
            }
            .search-input {
                padding: 10px;
                font-size: 0.9rem;
            }
            .suggestions-container {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            .suggestion-card {
                min-height: 250px;
            }
            .suggestion-title {
                font-size: 0.9rem;
            }
            .suggestion-subtitle {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <!-- Buttons at the top corners within the container -->
        <div class="top-buttons">
            <!-- About Button on the top-left -->
            <a href="about.html" class="top-button top-button-left" title="About">
                <img src="https://img.icons8.com/?size=100&id=77&format=png&color=FFFFFF" alt="About" style="width: 30px; height: 30px;">
            </a>
        
            <!-- Discord Button on the top-right -->
            <a href="https://discord.com/invite/cwDTVKyKJz" class="top-button top-button-right" title="Discord" target="_blank">
                <img src="https://img.icons8.com/?size=100&id=25627&format=png&color=FFFFFF" alt="Discord" style="width: 30px; height: 30px;">
            </a>
        </div>
    
        <!-- Title with Icon -->
        <div class="title-container">
            <img src="https://raw.githubusercontent.com/junioralive/Xyra/refs/heads/main/assets/xyra.png" alt="Xyra Logo" class="title-icon">
            <h1 class="title" id="title">Xyra</h1>
        </div>
    
        <!-- Search Bar -->
        <div class="search-bar" id="searchBar">
            <input type="text" id="searchInput" class="search-input" placeholder="Search Movie/TV Show...">
        </div>

        <div class="section-title" id="sectionTitle">Continue Watching...</div>
        <div id="searchSuggestions" class="suggestions-container">
            <div class="section-title" id="sectionTitle"></div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="footer">
        Made with ♥ by <a href="https://github.com/junioralive/Xyra">JuniorAlive, Xyra Stream</a><br>
        <small>
            Xyra does not host any files; it pulls streams from third-party services.
        </small>
    </footer>
    <script>
        const searchInput = document.getElementById('searchInput');
        const searchSuggestions = document.getElementById('searchSuggestions');
        const sectionTitle = document.getElementById('sectionTitle');
        const apiKey = '974dff81c8800d9dac708b4882d8cbb5';
        
        document.addEventListener('DOMContentLoaded', () => {
            sectionTitle.textContent = 'Continue Watching...';
            loadContinueWatching();
        });
        
        searchInput.addEventListener('input', async () => {
            const query = searchInput.value.trim();
    
            if (query.length < 2) {
                sectionTitle.textContent = 'Continue Watching...';
                loadContinueWatching();
                searchSuggestions.classList.add('show');  // Show the Continue Watching section
                return;
            }
    
            sectionTitle.textContent = 'Search Results';
            searchSuggestions.classList.add('show');  // Show the Search Results section
            const response = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${apiKey}&query=${encodeURIComponent(query)}`);
            const data = await response.json();
            displaySuggestions(data.results);
        });
        
        function clearMediaCards() {
            searchSuggestions.innerHTML = ''; // Clears all child elements of searchSuggestions
        }
    
        function displaySuggestions(results) {
            clearMediaCards();
            results.forEach(media => {
                const suggestionCard = createMediaCard(media);
                searchSuggestions.appendChild(suggestionCard);
            });
        }
        
        async function loadContinueWatching() {
            const progressHistory = JSON.parse(localStorage.getItem('progressHistory')) || [];
            clearMediaCards();
            if (progressHistory.length === 0) {
                sectionTitle.textContent = ''; // Clear title if no items
                searchSuggestions.classList.remove('show'); // Hide suggestions if no items
                return;
            }
            
            const mediaCache = {}; // Cache to avoid duplicate API calls
            sectionTitle.textContent = 'Continue Watching...';
            searchSuggestions.classList.add('show'); // Show suggestions if items exist
    
            for (const progressItem of progressHistory) {
                const mediaId = progressItem.id;
                const mediaType = progressItem.season ? 'tv' : 'movie';
    
                if (mediaCache[mediaId]) {
                    const mediaCard = createMediaCard(mediaCache[mediaId], mediaType, mediaId, true);
                    searchSuggestions.appendChild(mediaCard);
                } else {
                    try {
                        const response = await fetch(`https://api.themoviedb.org/3/${mediaType}/${mediaId}?api_key=${apiKey}`);
                        if (!response.ok) throw new Error('Failed to fetch media details');
                        const media = await response.json();
                        mediaCache[mediaId] = media;
                        const mediaCard = createMediaCard(media, mediaType, mediaId, true);
                        searchSuggestions.appendChild(mediaCard);
                    } catch (error) {
                        console.error('Error fetching media details:', error);
                    }
                }
            }
        }
        
        function createMediaCard(media, mediaTypeOverride = null, mediaId = null, isContinueWatching = false) {
            const suggestionCard = document.createElement('div');
            suggestionCard.classList.add('suggestion-card');
            suggestionCard.style.position = 'relative';
    
            suggestionCard.addEventListener('click', () => {
                const mediaType = mediaTypeOverride || media.media_type;
                window.location.href = `play.html?id=${media.id}&type=${mediaType}`;
            });
    
            const posterPath = media.poster_path
                ? `https://image.tmdb.org/t/p/w500${media.poster_path}`
                : 'https://via.placeholder.com/150x200?text=No+Image';
    
            const suggestionImage = document.createElement('img');
            suggestionImage.src = posterPath;
            suggestionImage.alt = media.title || media.name;
            suggestionImage.classList.add('suggestion-image');
    
            const suggestionDetails = document.createElement('div');
            suggestionDetails.classList.add('suggestion-details');
    
            const title = document.createElement('div');
            title.classList.add('suggestion-title');
            title.textContent = media.title || media.name;
    
            const typeAndYear = document.createElement('div');
            typeAndYear.classList.add('suggestion-subtitle');
            const typeText = mediaTypeOverride || (media.media_type === 'movie' ? 'Movie' : 'TV Show');
            const year = media.release_date
                ? media.release_date.split('-')[0]
                : media.first_air_date
                ? media.first_air_date.split('-')[0]
                : 'N/A';
            typeAndYear.textContent = `${typeText} · ${year}`;
    
            suggestionDetails.appendChild(title);
            suggestionDetails.appendChild(typeAndYear);
            suggestionCard.appendChild(suggestionImage);
            suggestionCard.appendChild(suggestionDetails);
    
            if (isContinueWatching) {
                const removeButton = document.createElement('button');
                removeButton.classList.add('remove-button');
                removeButton.innerHTML = '×';
                removeButton.addEventListener('click', (event) => {
                    event.stopPropagation();
                    if (confirm('Are you sure you want to remove this item from Continue Watching?')) {
                        removeFromContinueWatching(mediaId);
                    }
                });
                suggestionCard.appendChild(removeButton);
            }
    
            return suggestionCard;
        }
    
        function removeFromContinueWatching(mediaId) {
            let progressHistory = JSON.parse(localStorage.getItem('progressHistory')) || [];
            progressHistory = progressHistory.filter(item => item.id !== mediaId);
            localStorage.setItem('progressHistory', JSON.stringify(progressHistory));
            loadContinueWatching();
        }        
    </script>    
</body>
</html>
